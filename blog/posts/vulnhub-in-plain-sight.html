<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <title>Vulnhub : In Plain Sight üìù</title>
  <meta name="keywords" content="Vulnhub, write-up, in, plain, sight" />
  <meta name="description" content="Pour ce second write-up, nous allons faire In Plain Sight qui est une box cr√©√©e par bzyo. Pour trouver l‚ÄôIP de notre box, on lance la commande suivante netdiscover On voit ici que nous avons notre cible en 192.168.1.40, on lance donc un scan nmap sur l‚ÄôIP de notre box, pour cela on lance la commande nmap -A 192.168.1.40 Nous avons donc, du SSH √† jour..." />
  <meta property="og:title" content="Vulnhub : In Plain Sight üìù" />
  <meta property="og:url" content="https://eban.dev/blog/write-up/vulnhub-in-plain-sight" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Eban's Blog" />
  <meta property="og:locale" content="fr_FR" />
  <meta name="twitter:site" content="@eban_non" />
  <link rel="stylesheet" href="../css/index.css">
</head>
<body>
<div class="header">
<div class="nav">
<a href="https://eban.dev/blog/">ACCUEIL</a><a href="https://eban.dev/blog/contact.html">CONTACT</a><a href="https://eban.dev/blog/about.html">A PROPOS</a>
</div>
<h1>
Eban‚Äôs Blog
</h1>
</div>
<section id="vulnhub-in-plain-sight" class="article-list">
<h1>Vulnhub : In Plain Sight üìù</h1>
<p>Pour ce second write-up, nous allons faire In Plain Sight qui est une box cr√©√©e par bzyo.<br />
<a href="https://www.vulnhub.com/entry/in-plain-sight-101,400/">Ici</a>, le lien pour la t√©l√©charger</p>
<h2 id="enumeration">ENUMERATION</h2>
<p>Pour trouver l‚ÄôIP de notre box, on lance la commande suivante</p>
<blockquote>
<p>netdiscover</p>
</blockquote>
<p><img src="https://i.postimg.cc/RVrS70vj/Capture-d-cran-de-2020-04-22-15-14-01.png" /></p>
<p>On voit ici que nous avons notre cible en 192.168.1.40, on lance donc un scan nmap sur l‚ÄôIP de notre box, pour cela on lance la commande</p>
<blockquote>
<p>nmap -A 192.168.1.40</p>
</blockquote>
<p><img src="https://i.postimg.cc/vZKxdsrM/Capture-d-cran-de-2020-04-22-15-16-53.png" /></p>
<p>Nous avons donc, du SSH √† jour et sans faille connue, idem pour le serveur HTTP, ainsi qu‚Äôun serveur ftp ouvert avec, d‚Äôapr√®s nmap un fichier todo.txt accessible en lecture, la connexion en anonyme est autoris√©e sur le serveur ftp.<br />
On s‚Äôempresse donc d‚Äôaller voir du cot√© du serveur ftp, pour s‚Äôy connecter en anonyme on utilise la commande</p>
<blockquote>
<p>ftp 192.168.1.40</p>
</blockquote>
<p>On rentre donc anonymous en nom d‚Äôutilisateur et on ne met pas de mot de passe‚Ä¶</p>
<p><img src="https://i.postimg.cc/8PfnQhf0/Capture-d-cran-de-2020-04-22-15-22-54.png" /></p>
<p>On utilise ensuite la commande</p>
<blockquote>
<p>dir</p>
</blockquote>
<p>Pour afficher les dossiers et fichiers pr√©sents dans le r√©pertoire courant (√©quivalent √† ls sous linux)</p>
<p><img src="https://i.postimg.cc/vmBTqHcb/Capture-d-cran-de-2020-04-22-15-26-03.png" /></p>
<p>Nous voyons donc qu‚Äôil y a un fichier todo.txt qui nous est accessible en lecture.<br />
On le r√©cup√®re sur notre machine avec la commande</p>
<blockquote>
<p>get todo.txt</p>
</blockquote>
<p>On peut ensuite lire le fichier et voil√† ce qu‚Äôil contient</p>
<p><code>mike - please get ride of that worthless wordpress instance! it's a security risk. if you have privilege issues, please ask joe for assitance. &lt;br&gt;joe - stop leaving backdoors on the system or your access will be removed! your rabiit holes aren't enough for these elite cyber hacking types. - boss person</code></p>
<p>On comprend donc qu‚Äôil y a une instance wordpress vuln√©rable sur la machine cible ‚Ä¶<br />
On comprend aussi que l‚Äôutilisateur Joe a certains privileges sur notre machine cible.<br />
Regardons donc du c√¥t√© du serveur web.</p>
<p><img src="https://i.postimg.cc/SxyxR7Fg/Capture-d-cran-de-2020-04-22-15-36-57.png" /></p>
<p>En regardant cette page, quelque chose m‚Äôintrigue, il est √©crit</p>
<p><code>located at /var/www/html/index.htnl</code></p>
<p>Alors qu‚Äôil devrait etre √©crit‚Ä¶</p>
<p><code>located at /var/www/html/index.html</code></p>
<p>Regardons donc ce fameux fichier index.htnl, et bingo ! On tombe sur une page contenant un gif cliquable qui renvoie vers un autre page</p>
<p><img src="https://i.postimg.cc/T1TWxyxS/Capture-d-cran-de-2020-04-22-15-41-18.png" /></p>
<p>Allons voir vers quelle page nous envoie ce lien‚Ä¶<br />
Il nous renvoie donc vers une page o√π l‚Äôon peut mettre en ligne une image mais, malheureusement, il est impossible de bypasser les protections pour upload un fichier php‚Ä¶<br />
Ne serions nous pas tomb√©s dans une de ces fameuses fausses pistes dont parlait Joe au debut ? Pas si s√ªr‚Ä¶ Regardons du c√¥t√© du code source de la page !</p>
<p><img src="https://i.postimg.cc/zvTDzhTN/Capture-d-cran-de-2020-04-22-15-51-31.png" /></p>
<p>On voit donc en bas de la page, une chaine de caract√®re encod√©e en base 64</p>
<p><code>c28tZGV2LXdvcmRwcmVzcw==</code></p>
<p>On la d√©code donc avec la commande</p>
<blockquote>
<p>echo c28tZGV2LXdvcmRwcmVzcw== | base64 ‚Äìdecode</p>
</blockquote>
<p><img src="https://i.postimg.cc/sXz8b033/Capture-d-cran-de-2020-04-22-16-01-16.png" /></p>
<p>Cela ressemble √† une url de site wordpress‚Ä¶ On nous avait dit plus haut qu‚Äôil y avait une instance wordpress vuln√©rable, ca peut √™tre int√©ressant !<br />
Allons donc √† l‚Äôadresse :</p>
<blockquote>
<p><a href="http://192.168.1.40/so-dev-wordpress">http://192.168.1.40/so-dev-wordpress</a></p>
</blockquote>
<p>Nous arrivons donc sur un site wordpress classique mais, le css ne semble pas s‚Äô√™tre charg√©‚Ä¶</p>
<p>En regardant dans le code source, on voit que le fichier css est cens√© √™tre √† l‚Äôurl <a href="http://inplainsight/so-dev-wordpress/wp-content-themes/twentytwenty/print.css">http://inplainsight/so-dev-wordpress/wp-content-themes/twentytwenty/print.css</a></p>
<p>Il faut donc rajouter l‚Äôip de la box au fichier hosts de notre machine. Pour en savoir plus, je vous conseille la tr√®s bonne vid√©o de Processus Thief sur le fonctionnement des virtual hosts que vous pouvez retrouver <a href="https://www.youtube.com/watch?v=uG_bRjqUzFM.">Ici</a><br />
Nous effectuons donc la commande :</p>
<blockquote>
<p>nano /etc/hosts</p>
</blockquote>
<p>On rajoute donc la ligne :</p>
<p><code>192.168.1.40 inplainsight</code></p>
<p><img src="https://i.postimg.cc/BnKCp5Bf/Capture-d-cran-de-2020-04-23-11-43-11.png" /></p>
<p>Retournons donc sur le site, et voil√† ! Notre css est maintenant charg√©</p>
<p><img src="https://i.postimg.cc/G3jMZjDF/Capture-d-cran-de-2020-04-23-11-46-14.png" /></p>
<p>D‚Äôapr√®s ce que l‚Äôon sait, ce wordpress est vuln√©rable, lancons donc wpscan avec rockyou comme liste de mot de passe et les utilisateurs admin, mike et joe avec la commande :</p>
<blockquote>
<p>wpscan ‚Äìurl <a href="http://192.168.1.40/so-dev-wordpress/">http://192.168.1.40/so-dev-wordpress/</a> ‚Äìpasswords /usr/share/wordlists/rockyou.txt ‚Äìusernames admin,mike,joe</p>
</blockquote>
<p><img src="https://i.postimg.cc/tgCh17N8/Sans-titre.png" /></p>
<p>Et voila, nous avons trouv√© un couple user/pass qui est</p>
<p><code>admin/admin1</code></p>
<p>Connectons nous √† l‚Äôinterface d‚Äôadmin de wordpress</p>
<p><img src="https://i.postimg.cc/gJKyrRC9/Capture-d-cran-de-2020-04-23-12-09-58.png" /></p>
<p>Nous avons donc acc√®s √† la page d‚Äôadministration de wordpress !</p>
<p>Il est possible d‚Äôenvoyer un reverse shell avec wordpress. Pour ce faire, il faut modifier une des pages du theme wordpress, pour cet exemple nous allons modifier le fichier 404.php.<br />
Pour ce faire, allons dans la rubrique Appearance puis theme editor.</p>
<p><img src="https://i.postimg.cc/qvVGGJYL/Capture-d-cran-de-2020-04-23-14-19-13.png" /></p>
<p>Dans le panneau de droite, s√©lectionnez 404 Template</p>
<p><img src="https://i.postimg.cc/3JMJkGrc/Capture-d-cran-de-2020-04-23-14-23-56.png" /></p>
<p>Il ne reste plus qu‚Äô√† ajouter au fichier 404.php un reverse shell en php trouv√© dans les reverse shell int√©gr√©s √† kali dans le r√©pertoire.</p>
<p><code>/usr/share/webshells/php/php-reverse-shell.php</code></p>
<p><img src="https://i.postimg.cc/zBdcM6pc/Capture-d-cran-de-2020-04-23-14-33-00.png" /></p>
<p>On lance un listener netcat.<br />
On va donc ensuite sur la page 404.php que l‚Äôon vient de modifier. Voici le lien :</p>
<blockquote>
<p><a href="http://192.168.1.40/so-dev-wordpress/wp-content/themes/twentytwenty/404.php">http://192.168.1.40/so-dev-wordpress/wp-content/themes/twentytwenty/404.php</a></p>
</blockquote>
<p>On re√ßoit donc un shell dans notre terminal o√π nous avions lanc√© netcat !</p>
<p><img src="https://i.postimg.cc/k5fp2GzH/Capture-d-cran-de-2020-04-23-14-52-32.png" /></p>
<h2 id="exploitation-elevation-de-privilege">EXPLOITATION &amp; ELEVATION DE PRIVILEGE</h2>
<p>Apr√®s avoir spawn√© un shell tty, on regarde si il y a quelque chose dans /home, on remarque que dans /home/joe, il y a un fichier ‚Äújournal‚Äù qui ne nous est pas accessible en √©criture‚Ä¶<br />
Dans le /home de mike, il n‚Äôy a rien. Allons donc voir du cot√© de la configuration de wordpress‚Ä¶ Dans le dossier</p>
<blockquote>
<p>/var/www/html</p>
</blockquote>
<p>Il y a un fichier wp-config, regardons ce que contient ce fichier</p>
<p><img src="https://i.postimg.cc/X7z3JwpT/Capture-d-cran-de-2020-04-23-15-04-04.png" /></p>
<p>On trouve donc des identifiants d‚Äôune base de donn√©es mysql‚Ä¶ On essaye donc de se connecter √† la base de donn√©es avec la commande :</p>
<blockquote>
<p>mysql -u sodevwp -p</p>
</blockquote>
<p>On utilise comme mot de passe celui trouv√© dans wp-config.php, une fois connect√©, pour voir les bases de donn√©s pr√©sentes, on utilise la commande.</p>
<blockquote>
<p>show databases;</p>
</blockquote>
<p><img src="https://i.postimg.cc/C5fXmLyJ/Capture-d-cran-de-2020-04-23-15-22-48.png" /></p>
<p>On voit ici qu‚Äôil y a une base de donn√©es nomm√©e sodevwp, on utilise donc les commandes suivantes pour voir le contenu de la base de donn√©es sodevwp.</p>
<blockquote>
<p>use sodevwp;<br />
show tables;</p>
</blockquote>
<p><img src="https://i.postimg.cc/bvPs69GF/Capture-d-cran-de-2020-04-23-15-27-14.png" /></p>
<p>On regarde donc ce que contient la table sodevwp_users avec la commande :</p>
<blockquote>
<p>select * from sodevwp_users;</p>
</blockquote>
<p><img src="https://i.postimg.cc/BQ1tcnZ6/Capture-d-cran-de-2020-04-23-15-32-30.png" /></p>
<p>Int√©ressant ! Nous avons donc le mot de passe hash√© de l‚Äôutilisateur mike !<br />
Crackons le avec john sur notre machine en utilisant la commande :</p>
<blockquote>
<p>john ‚Äìwordlist=/usr/share/wordlists/rockyou.txt mike_password.txt</p>
</blockquote>
<p><img src="https://i.postimg.cc/3wRCHry2/1-3-x-J8q-Zz-Ot1vg8-FXLXTH5-A.jpg" /></p>
<p>Nous avons donc le mot de passe de mike !<br />
Essayons de nous connecter √† l‚Äôutilisateur mike avec la commande :</p>
<blockquote>
<p>su mike</p>
</blockquote>
<p>Et voila ! Nous avons un shell en tant que mike ! On spawn donc un shell tty.</p>
<p><img src="https://i.postimg.cc/Z5WGHNZd/Capture-d-cran-de-2020-04-23-16-04-29.png" /></p>
<p>Nous pouvons ensuite regarder le contenu de /etc et on remarque un fichier passwd-, √©trange‚Ä¶ En regardant le contenu de ce fichier, on remarque que le mot de passe de joe est en clair dans le fichier ! Essayons donc de nous connecter au compte de joe avec la commande :</p>
<blockquote>
<p>su joe</p>
</blockquote>
<p><img src="https://i.postimg.cc/cJBBnsCb/Capture-d-cran-de-2020-04-23-16-13-56.png" /></p>
<p>En utilisant SmashMouthNoThanks comme mot de passe.<br />
On cherche donc si on peut trouver quelque chose d‚Äôint√©ressant‚Ä¶ Et dans le dossier /sbin/, il y a executable nomm√© bwrap, quand on lance l‚Äôexecutable, on obtient un shell en tant que root..</p>
<p><img src="https://i.postimg.cc/WbrZyf4s/Capture-d-cran-de-2020-04-23-16-38-55.png" /></p>
<p>Et voil√†, cette box est termin√©e ! Merci d‚Äôavoir lu ce write-up en entier ! Si vous avez des retours, n‚Äôh√©sitez pas √† me contacter sur twitter <span class="citation" data-cites="eban_non">@eban_non</span>.</p>
<p><img src="https://i.postimg.cc/wMkQSf6f/Capture-d-cran-de-2020-04-23-16-43-21.png" /></p>
</section>
</body>
</html>
